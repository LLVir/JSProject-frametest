<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">

    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
        <title>Babylon Template</title>

        <style>
            html, body {
                overflow: hidden;
                width: 100%;
                height: 100%;
                margin: 0;
                padding: 0;
            }

            #renderCanvas {
                width: 100%;
                height: 100%;
                touch-action: none;
            }
        </style>

        <script src="babylon.js"></script>
        <script src="babylon.gui.min.js"></script>

    </head>

   <body>

	<canvas id="renderCanvas"></canvas>

	<script>

        const canvas = document.getElementById("renderCanvas"); // Get the canvas element
        const engine = new BABYLON.Engine(canvas, true); // Generate the BABYLON 3D engine

        const createScene = function () {
            // This creates a basic Babylon Scene object (non-mesh)
            const scene = new BABYLON.Scene(engine);


	/**** Set camera and light *****/
	const camera = new BABYLON.ArcRotateCamera("camera", (-Math.PI / 2) - 0.1, Math.PI / 3.5, 5, new BABYLON.Vector3(0, 2, -3));
	camera.setTarget(new BABYLON.Vector3(0, 0, 0));
	// Positions the camera overwriting alpha, beta, radius
	camera.attachControl(canvas, true);

	const light = new BABYLON.HemisphericLight("light", new BABYLON.Vector3(1, 1, 0));
	scene.ambientColor = new BABYLON.Color3(1, 1, 1);


		/* Paul's original
	// Our built-in 'sphere' shape.
	var corner1 = BABYLON.MeshBuilder.CreateCylinder("sphere", {diameter: 2, subdivisions: 1, height: .3, arc: .25}, scene);
	var corner2 = BABYLON.MeshBuilder.CreateCylinder("sphere", {diameter: 2, subdivisions: 1, height: .3, arc: .25}, scene);
	var middle = BABYLON.MeshBuilder.CreateBox("Middle", {width: 1, height: .3, depth: 1}, scene);
	let centerDistance = 3;
	corner1.position.x = centerDistance;
	corner2.position.x = centerDistance * -1;
	corner2.scaling.x = -1;
	middle.position.z = -.5;
	middle.scaling.x = centerDistance*2;

	const meshArray = [corner1, corner2, middle];
	const halfMesh = BABYLON.Mesh.MergeMeshes(meshArray);
	const newhalf = halfMesh.clone();
	newhalf.scaling.z = -1;
	*/


// create middle section

	// dimension
	const c_width = 4;
	const c_height = 0.2;
	const c_depth = 2;

	// create the mesh that includes the UV
	const c_middle = BABYLON.MeshBuilder.CreateBox("Middle", {
		faceUV: [
		    new BABYLON.Vector4(0, 0, c_width, c_height), //rear
		    new BABYLON.Vector4(0, 0, c_width, c_height), //front
		    new BABYLON.Vector4(0, 0, c_depth, c_height), //right
		    new BABYLON.Vector4(0, 0, c_depth, c_height), //left
		    new BABYLON.Vector4(0, 0, c_width, c_depth), //top
		    new BABYLON.Vector4(0, 0, c_width, c_depth)  //bottom
		],
		wrap: true,
		updatable: true,
		width: c_width,
		height: c_height,
		depth: c_depth
	}, scene);

// create the corner1 section
	
	// dimension
	const c_diameter = c_depth; // make the diameter match the depth of the box
	const c_corner1RotY = Math.PI * -0.5; // rotate the cylinder 180 degree where the opening matches up the edge of the box
	const c_corner1PosX = c_width * 0.5; //position the cylinder where the opening matches up the edge of the box
		
	// create the mesh that includes the UV
	const c_corner1 = BABYLON.MeshBuilder.CreateCylinder("corner1", {
		faceUV: [
		    new BABYLON.Vector4(0, 0, c_diameter, c_diameter), //bottom
		    new BABYLON.Vector4(0, 0, Math.PI, c_height), //side
		    new BABYLON.Vector4(0, 0, c_diameter, c_diameter), //top
		],
		wrap: true,
		updatable: true,
		diameter: c_diameter,
		height: c_height,
		arc: 0.5
	}, scene);

	c_corner1.position.x = c_corner1PosX;
	c_corner1.rotation.y = c_corner1RotY;

// create the corner2 section with instance

	//const c_corner2 = c_corner1.createInstance();// instance meshes can't not be merge later 
	const c_corner2 = c_corner1.clone();//use clone instead
	c_corner2.position.x = c_corner1PosX * -1;
	c_corner2.rotation.y = c_corner1RotY * -1;

// set material for the meshes
	const Mat = new BABYLON.StandardMaterial("Mat", scene);
	Mat.diffuseTexture = new BABYLON.Texture("https://www.babylonjs-playground.com/textures/amiga.jpg");
	Mat.ambientColor = new BABYLON.Color3 (0.5, 0.5, 0.5);
	c_middle.material = Mat;
	c_corner1.material = Mat;
	c_corner2.material = Mat;

// create merge mesh
	const meshArray = [c_corner1, c_corner2, c_middle];
	const c_final = BABYLON.Mesh.MergeMeshes(meshArray, );
	c_final.name = "newMesh";





// show inspector properties
	scene.debugLayer.show();







            return scene;
        };

        const scene = createScene(); //Call the createScene function

        // Register a render loop to repeatedly render the scene
        engine.runRenderLoop(function () {
                scene.render();
        });

        // Watch for browser/canvas resize events
        window.addEventListener("resize", function () {
                engine.resize();
        });
	</script>

   </body>

</html>
